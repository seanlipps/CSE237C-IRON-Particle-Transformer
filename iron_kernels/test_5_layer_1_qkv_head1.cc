#include "iron_kernels.h"

// Fused QKV kernel for head 0
extern "C" {

#include <cstdint>
int8_t wq_head1 [1024] = { -78, 88, -49, 119, 23, -82, -100, -92, -62, -87, -116, 22, -33, -61, 64, 91, 69, -100, 6, 117, -10, -2, -116, 35, -3, -18, -122, -117, -117, 54, 102, 23, -6, 121, -102, -58, -25, 19, -47, 115, -16, -66, -91, -3, -112, -72, 85, -3, 88, 67, -93, -40, 26, 120, 125, 18, -22, 33, 123, 108, -6, -11, -60, 118, -113, -19, 110, 15, -68, 28, 113, 66, -119, 96, 88, 13, 77, -43, 32, 67, 24, -55, 17, -34, 113, 64, -125, -107, 119, 96, 28, 82, -62, 61, -77, 74, 15, -127, 97, 51, -85, 111, -24, 34, -54, -17, 121, 121, -13, -65, -41, 49, -64, 103, 50, 126, 29, 6, 15, 60, 66, -74, 13, 63, -55, -30, 93, 32, 79, -67, -61, -27, 2, -33, 52, 100, 41, 24, -32, 123, 50, -20, -84, -119, 26, 52, -86, 44, -52, 101, -31, 20, -50, 59, -34, -83, 4, 118, -101, 46, -50, 23, 33, 105, 0, 103, 17, -94, 16, -46, -97, -1, 72, -23, -67, -118, 96, -86, 62, -105, -62, -125, -19, -114, -97, 102, -120, 77, 127, -5, 66, 37, 26, 5, -122, 105, -69, -22, 87, 19, -23, 123, -58, 18, -78, -113, -10, -14, 119, 14, 114, -79, -78, -31, 76, 40, -31, -41, -40, -29, 106, -81, -126, 110, 108, -92, -109, 68, 31, 60, 92, 108, -72, 123, 93, -87, 29, 16, 34, -62, -20, 4, -87, 20, 105, -107, 24, -61, -51, 99, -77, -5, 85, -67, -32, 85, -119, 29, 62, -31, -112, 117, -71, 2, 0, 110, -38, 53, 106, -2, -128, -51, -67, 88, 25, 10, -52, 119, -47, 20, 95, 79, -77, 82, 124, 26, -40, -123, 112, -61, 113, 105, 8, 85, -93, -79, 115, 1, -79, -28, 39, 31, 95, 106, -97, 110, -99, 47, 13, 125, 117, -39, -75, 43, -69, 8, -63, 16, -102, -63, -98, 117, -42, -45, 111, 108, -126, 50, 20, -119, -122, 74, 78, -126, -38, 118, 74, -65, 84, -100, -27, -29, 73, 108, 89, -103, -39, 123, -22, 54, -112, -116, -58, 70, 100, -7, 4, -106, -85, -65, 104, 48, 96, -110, -44, 35, 95, -13, 73, -43, 99, 82, 124, -18, 89, 21, 89, 67, -80, 80, -128, 112, 15, 5, -81, -108, 32, 22, 119, -98, 41, 69, -12, -48, -103, 102, -54, 3, -23, 110, 51, 93, 20, 113, 11, 64, 14, -35, 44, 52, 114, -72, -21, 104, -108, 72, -86, -10, -108, -65, 30, -9, 117, -98, -38, 2, 116, -94, -101, 32, 102, -85, 100, 50, -127, -6, -75, -119, -118, 103, -64, -105, 60, -13, 97, 51, -68, -9, 23, 16, 26, -96, -119, 96, -15, -47, -73, 105, -124, -106, -119, -45, 82, -83, -49, -73, -123, -77, -54, 127, -89, -55, 42, 11, 72, 14, 94, -5, -128, -21, 20, -16, -118, 19, 0, 64, -80, 28, 49, -60, -122, -48, 91, 2, 112, -86, -68, -116, 19, -63, -112, 97, 84, -71, 41, -20, -120, -27, -82, 127, -68, 86, 69, 71, -109, 5, -82, -101, -58, 85, 97, 83, -85, -28, 7, -102, 122, -118, 127, -4, 35, 82, -15, 7, -46, -102, 77, -56, -61, -104, 87, -82, -67, -91, -18, -48, -38, 117, 118, -34, -1, 28, 22, -19, 41, 33, -36, 118, -88, -92, -9, 82, -127, 44, 32, -61, -61, -48, -125, -20, 30, 59, 79, -73, 55, 73, 76, 24, -67, -19, 86, 24, 126, 98, 112, -97, -1, -9, 42, -5, 7, 51, -29, -115, 87, -83, -74, 99, -104, 12, 11, -106, -63, -127, 113, 38, -48, 111, -51, -23, -19, 55, 8, 105, 88, 91, 120, 52, -70, -37, -17, 35, 10, -104, 110, -65, 47, 66, 23, -35, -45, 85, -112, -32, -96, 5, 12, -93, 86, 20, -63, -42, 74, 120, -9, -34, -96, -121, -87, 68, -84, 54, -19, 74, -107, 72, -91, -78, -81, -86, -57, 5, -1, 34, -45, 125, -117, -79, -43, -28, 44, -26, -46, 46, -62, -111, 35, 68, 104, 61, -11, -73, -97, 7, 37, -26, -113, 76, 93, -10, -97, -41, -65, 70, 75, 1, 79, -125, 19, -19, -121, 109, 117, -75, 28, 9, 80, 43, -113, 85, -54, -53, -118, 40, -105, 88, 40, -86, 95, -80, 17, 44, -2, 96, 51, 12, 39, 109, -98, 66, -99, -98, 33, 85, -98, 123, -81, 43, 116, 69, -19, -49, 50, 53, 119, -87, 120, -38, 12, 44, 62, 28, 97, 20, 30, -51, -6, -44, -20, -73, 117, 79, 79, 87, 70, -54, 42, 13, -125, -69, 70, -82, 99, -63, -69, 109, 83, -7, 33, -65, 0, 83, -54, -19, 91, 72, 27, -92, -35, 26, 15, -7, -108, -46, 95, 127, 57, 2, -62, 105, -112, 107, 81, -79, 75, 117, -120, -107, -9, -86, 103, -57, 76, 34, 116, -77, -35, 31, 24, 38, 96, 100, 23, 9, 119, -36, 4, -85, -115, 108, 45, 119, -20, 83, 60, 120, -53, -63, -112, 0, 43, -34, -83, 111, 95, -78, 80, 43, -123, -45, 4, -125, -56, 121, 54, 26, 39, -126, 42, 70, 110, -127, 35, -54, 100, -11, 42, 71, 53, 80, 45, -116, -45, 12, -113, 59, -7, 84, 50, 57, -71, -10, 66, -61, -16, 8, 34, -51, 69, -49, -38, -90, -96, 20, 100, 113, -108, -66, 102, -33, 57, -35, 3, -13, -9, -117, 72, -30, 23, -90, -127, -37, -60, -82, 42, 22, -35, -47, -85, 91, 20, -21, -49, 65, -100, 95, 99, 124, -71, 115, -75, 45, 19, -94, -78, -96, 105, 47, 62, -21, -108, -23, 55, 41, 40, 59, 81, -92, 89, 36, 58, -114, -95, -108, -10, 48, -119, 67, -90, -63, -67, 101, -93, -7, -122, -101, 63, -112, 77, 109, -11, 28, -118, -9, 57, 35, -26, -68, -19, -95, 10, 40, -68, -2, -23, -53, -79, -4, 60, -6, -115, -12, 4, 49, -86, 40, 68, -89, -85, 55, 82, 80, 92, -32, -65, 67, -123, 111, -12, 102, 55, 63, -99, 118, -58, -66, -73, -120, -117, -37, -97, -46, -7, 105 };


int8_t wk_head1 [1024] = { -27, -38, 109, -67, -21, -49, -23, -96, -63, 33, -19, 78, 115, 53, -39, 83, 82, 86, 3, -2, -121, 84, 69, 17, 92, 91, 113, -54, -1, 18, -69, 20, -82, 65, 2, -31, -1, 64, 46, -128, -106, 26, 108, -112, 122, -83, -122, -19, 14, -32, 52, 57, -22, -82, 81, -11, -25, 76, -56, -89, -3, 3, -121, 86, 48, 25, -23, 59, 87, 46, 7, -76, 60, 88, -9, -13, 74, -118, 1, -65, -46, 25, 115, -8, -88, -126, -83, 98, 7, -75, 23, -26, -99, 123, -51, -24, -13, 68, -38, -66, -10, -61, -41, 49, -9, 113, -98, -121, 68, -21, 10, -56, -110, -16, 84, -7, -103, -1, -36, 3, -91, 47, 68, -71, 25, 95, 53, -52, 124, -22, 22, 123, 91, 79, 41, -25, -16, -9, 116, 109, -86, -36, -100, -56, -90, -39, 82, 116, -18, 120, 127, 111, -104, 77, -19, -59, 33, -106, 61, 7, 34, -15, -66, 74, 29, 80, -66, -91, -21, -33, 67, -82, 26, -92, -47, -26, 124, -6, -64, 81, 46, 20, 112, -28, -64, 32, 123, -94, -6, -31, 17, 8, 74, -113, 65, -19, 46, 106, -113, 95, 3, 111, -101, -77, 12, -107, -123, 95, -23, 28, -13, 55, -116, 3, 22, -17, 60, -41, 25, -30, -45, -46, 71, 56, -62, 60, -119, -9, -61, 29, -42, 54, 97, -10, -74, 72, 58, -112, 126, 78, 72, -91, 43, -97, -46, -59, -128, -29, 61, 78, -31, 63, -103, 99, -88, 98, 57, -116, 95, 125, 22, 13, -35, 22, 79, -88, 50, -53, 37, -24, -96, 4, -68, 1, 27, -100, 105, -1, -90, -43, 34, -64, 84, 112, -85, 35, 30, 74, 10, -21, -13, 55, -113, 50, 43, -91, -52, 27, 36, -79, 116, -20, -76, 79, -101, -18, -17, -82, -28, 20, 63, -35, -51, 66, -76, -16, 6, 28, -118, -66, 126, -120, -48, 107, 72, 101, 50, -2, -16, -56, -10, 24, 76, 61, 88, -84, -34, 106, -60, -87, -25, 38, 14, -14, 96, 84, -112, -38, -52, 38, -69, 33, -111, -80, -53, -33, -60, -1, -29, 4, 3, -86, -101, 48, 99, 123, 2, -1, 78, 25, -69, -8, -60, 59, -89, 80, -32, -26, -111, 98, -47, -115, -97, -36, 67, -52, -52, -95, -13, 99, 8, -11, -6, 1, -86, -82, 83, 99, 32, -47, 51, 77, -100, -53, -25, -35, 43, -16, 40, -25, 122, -128, 23, 1, -105, 11, -11, 66, 109, 32, -14, 13, 60, -43, 86, 3, 48, 12, -44, -24, -16, -101, -109, -58, 3, 40, -41, -122, 97, -120, -8, -105, 42, 46, 99, -29, -26, 65, -2, -60, -100, -96, 107, 3, 118, -91, 53, 110, 97, 69, 50, -48, -83, -34, -83, -44, 98, -12, -12, -113, 80, 42, -61, -81, -4, 42, -28, 96, 127, -57, 6, -118, -39, -64, -11, -33, 112, -31, 18, 53, 66, 52, -59, -92, -75, 103, -84, -81, -56, -23, 26, 102, 7, 91, -46, -102, 41, 87, -100, -5, 96, 127, -60, -15, -64, 1, -108, -107, -108, 33, -103, 94, -98, 21, 10, -127, -53, 49, 9, 30, -96, 13, -66, -54, -85, -39, -125, -124, 79, -19, 35, 59, 97, 7, 105, 21, 7, -5, 2, -52, -4, -9, 99, 41, 114, -58, 27, 126, 105, -59, 103, -39, -71, 46, -120, 46, 91, -86, 104, 71, 0, 17, -76, 63, 58, -111, -126, 70, 88, -107, -115, -99, -83, -128, 37, 113, -110, 69, -39, -62, 26, -69, 95, -22, -3, -84, 115, -72, 3, -17, -113, -48, -65, 17, 85, 37, 0, 33, -4, 110, 37, 27, -100, 126, -16, 82, -86, 2, 67, 52, 71, -34, -17, 126, -26, 86, 75, 52, 68, 91, 104, -58, -44, 15, 101, 0, -123, 48, 57, 5, 75, 91, -124, -2, 36, -96, 108, -127, -73, -128, 87, 81, -58, -70, -23, 121, -55, -16, -117, 33, 127, 93, 20, 85, -125, 54, -49, 47, -79, 115, -124, -13, 55, 72, -39, -58, 107, 45, 120, 61, -94, 24, -118, 16, 85, -47, -35, 19, -76, 77, -119, -1, -5, 34, -40, -45, -6, -62, 115, -112, -48, -118, -8, -56, 94, -98, 116, 43, 106, 50, 59, 118, 23, 47, 10, 16, -70, 85, -76, -120, 107, -55, 36, -71, -55, 27, -5, 49, 118, -10, -121, -34, -78, -7, -17, 14, -26, -28, 94, -110, -107, 108, 63, -119, -32, -46, -41, 91, -45, -5, -115, 60, 11, -45, 24, -17, 27, 121, -19, 16, 55, 19, 35, -118, -101, 99, -10, -79, -13, -37, -2, 120, 11, 125, -51, -8, -23, 32, 35, -94, -4, 87, 118, 102, 0, 82, -113, -31, -110, 125, -105, 33, -103, 124, -76, -105, 33, -23, -54, 24, -46, -50, 78, 2, -52, -54, -69, 52, 92, 46, 34, -100, 101, -68, 45, -22, 52, -21, 89, 76, 119, 119, -98, -80, 11, 46, 84, 93, -59, -43, 53, 105, 81, -40, 62, 42, 27, -78, -24, 105, -6, 122, 123, -100, 80, -107, 25, -47, 38, 63, 46, -63, -15, 115, -74, -69, -11, 126, -43, -43, -67, -88, -5, 15, -127, -76, -58, -1, 5, -5, -44, -63, 73, -92, 105, 68, -67, 2, 61, -1, 46, -86, -25, -27, 74, -41, 67, -15, -68, 67, 90, 4, -76, 79, 105, -22, -9, 41, 41, -35, -42, -37, 17, -38, -35, -39, 108, -49, 10, 40, -71, 89, 107, -64, 15, -46, 12, -109, 123, -68, 61, -46, 46, -113, -37, 91, 21, 7, 112, -32, -14, -77, -92, -18, -26, -87, 126, -111, -80, -29, -128, -62, -39, -124, -33, -87, -12, -40, 44, 124, 81, 14, 38, -10, -36, 95, -5, 75, 44, -45, -7, 69, 105, 91, -68, 126, -53, 55, 97, 49, 40, 65, -36, -23, 97, -28, -14, -44, 72, -5, 104, -75, 100, 78, -126, -78, -111, 26, 78, -40, 60, 119, -18, -79, 54, -107, -48, 88, -74, -123, -119, -90, -63, 65, -82, -116, 56, -4, 84, -38, -105, 49, 37, 62, 3, 121, 119, 75, 82, 117, 95, 118, 33, 14 };

int8_t wv_head1 [1024] = { -71, 87, -100, 24, 76, 122, -97, -62, 70, 1, -103, 27, 10, 63, 91, -122, 86, 38, -22, -55, 125, 7, -19, 40, -17, -81, 88, -13, 120, -70, -116, -101, -45, -93, 28, -62, 126, 69, -77, -115, -106, 64, 86, 99, -21, -118, 88, 23, 68, 10, -36, 81, 44, -76, 126, -53, -74, -125, 125, 49, 98, -26, 102, 51, 11, 88, -117, 10, 71, 30, 92, -67, 95, 31, -60, -124, 105, 18, -99, 86, -108, 111, -11, 5, -113, 15, 117, -111, 123, -76, -82, 74, 24, 38, -45, 9, 39, -25, -9, 37, 105, -81, -1, 108, 97, 102, 48, -43, -99, -107, -19, 103, -100, -76, -118, -65, -41, -17, -74, 28, 99, -106, -99, -47, 56, 90, -97, 42, -36, -82, 67, 11, -2, -83, -32, 10, -9, -12, 26, 117, 98, -7, 64, -50, 41, -4, -83, -16, 60, 88, 36, 25, 20, 102, 94, 121, -101, 59, -117, 70, 106, -63, 22, 40, 45, 20, 12, 73, 15, -105, -98, -73, 116, -48, -122, 26, -79, 97, 70, 87, -34, 64, 99, -10, 50, -73, -23, 11, -99, 22, -86, -89, 110, -12, 47, 96, -110, 106, -76, 39, 118, 127, 88, -87, -96, -4, 1, 75, -44, 90, 46, 85, -113, 117, 81, -30, 114, -28, 29, 72, -46, -105, 17, 54, 54, 109, -115, 8, 76, 78, 111, -126, -109, -102, 93, -94, 18, -103, 119, -50, 28, -36, -63, 118, 127, 83, 4, 82, -70, -105, -46, 40, 59, 15, -101, -42, -58, 42, 102, 29, -25, 2, -110, -42, 18, 2, 54, -76, 45, -121, 28, 122, -61, -71, 109, 16, 21, 41, 4, -108, -69, 101, -43, 90, -14, 43, 19, -78, 98, 86, -27, -11, -27, 124, -100, 23, 49, 21, -19, 17, 68, 52, -97, -65, 36, -23, -44, -107, -127, -59, 92, 116, 115, 73, 65, -66, -61, -107, 40, 65, -126, 29, -72, 24, -86, -103, -120, 39, -58, 61, -74, 109, -41, 27, -20, 55, -37, 80, 117, -122, -11, 19, -62, -57, 109, -12, -7, 92, -103, -18, -102, -12, 91, -10, -14, -49, 27, 13, 28, -46, -14, 115, 54, -52, -80, -70, 34, 16, 111, 68, 15, -90, -82, -90, -37, 78, -4, 45, -13, -118, -107, -43, 33, -77, -9, -38, -107, -32, -3, 9, -5, -42, 0, -84, 96, 78, 40, -74, 121, -100, -96, 16, -104, 6, 68, -3, -87, 77, 37, 1, -33, -61, -54, -59, 21, 99, -112, 73, -57, 74, 42, 28, -11, -13, 82, -49, -47, 126, 126, -20, 15, 80, -70, 97, 124, -16, 15, 50, 114, 13, -108, 63, -9, 69, -76, -114, 68, 94, -105, 5, 33, 3, -19, 30, 78, -126, -51, -7, -121, -43, -20, -70, -113, 119, 106, -75, -108, -96, 103, 119, -108, -99, -64, -3, 101, -93, -63, -76, 70, 21, 53, 79, -110, 119, 127, 32, -123, -53, 43, -13, 48, -119, 48, -38, 23, -116, -104, -55, -124, -24, 13, -102, -28, -121, -51, -39, 1, 127, -70, 28, -98, 57, -118, -42, -125, -24, 115, 36, -14, -57, -14, 48, -42, 1, 90, -90, 36, 81, -125, 55, -56, 38, 64, 118, 4, -37, 21, -65, -33, 54, -49, 97, 4, 77, 75, 72, -11, -116, 93, -116, -10, -79, 108, 67, 51, -79, 106, -32, 28, 126, 32, 69, -56, 46, 24, -112, -100, 84, -118, -28, -24, -92, 102, -41, -28, -35, -123, 32, -110, 2, 121, 33, -97, 92, -6, 78, 79, 116, -4, -7, 95, -96, -123, -98, -40, -34, 48, 116, 66, -19, -19, 38, -57, -43, 35, -11, -62, -38, -11, -114, 116, 39, -76, 112, 55, 1, 87, -98, 35, 121, 37, -103, -78, 87, -90, 106, -22, -89, 14, -84, -7, -43, -124, -5, 11, -79, -127, 21, 81, -92, -104, -29, 106, 34, -120, 56, 26, -60, -51, -49, 78, 40, 15, 2, -61, 72, -72, -20, -10, -15, -17, 28, 42, -58, 56, -43, 45, 79, 106, 20, 49, 122, 21, 76, 88, 67, -74, 66, -10, -98, -102, 85, 21, 73, 57, 45, 91, 23, 50, 84, 103, 47, 37, 72, -42, 29, -58, 25, 116, -105, 87, -28, 105, 91, -88, -126, 35, 114, -23, 96, 127, 119, 121, 10, 83, 105, 3, -58, -114, -122, -10, 71, -78, -114, -81, -93, -7, 121, 116, 77, 98, 20, -15, -93, -105, -125, 95, 33, -64, -29, -101, -86, 84, -73, 120, -119, 124, -111, -79, -47, 21, 48, -74, -40, -104, 44, 103, 37, -49, -54, 22, 104, -73, -79, 5, -87, 13, -10, -118, -86, 101, 41, 35, 29, 12, 33, 69, -127, -48, -80, 98, -43, 82, -11, -9, -11, 99, 4, -107, -57, 111, 76, -23, 105, -26, 104, 114, -126, 66, 34, 120, -94, 4, -123, 87, -112, 25, 118, -33, 48, 3, 108, -38, 70, 39, 116, -92, -16, -36, -24, 95, 2, 105, -34, -28, -116, 122, 85, -104, 41, -31, -57, 123, 100, 54, -75, 17, -119, -119, 111, -25, 8, -102, 101, -122, -49, -2, -128, -120, 24, -52, 117, -90, 43, -109, -9, -29, 64, -112, -126, 106, 56, 19, -121, -37, -60, -128, -71, 87, -33, -45, -19, 97, 35, -81, 46, -125, -38, 94, 6, 108, -73, -89, -61, -58, -102, 35, 68, -123, -91, -82, -86, -60, -99, 44, 121, -37, -84, -64, 92, 102, -51, 113, -35, 106, 26, -58, 8, -41, 100, 88, -8, -76, -11, -32, 88, -19, 44, 80, 61, 102, -23, -83, 86, 79, -24, -31, -44, -86, -36, 15, -15, 2, -24, 127, -36, -122, 79, -103, -90, -18, 22, 9, 109, -33, 85, 7, -74, 37, 77, -3, 12, 48, 17, 49, -45, -50, -100, 98, -16, 93, -66, -39, -29, 81, -48, 5, -47, 46, 107, 37, -9, -50, -9, 39, -120, -28, 127, -109, 81, -120, 10, 47, 28, 89, 59, -36, -8, 37, 96, 74, 90, -63, -86, -78, -92, -42, 89, -8, -61, 10, 4, -71, -100, -34, 50, 107, -95, -115, -37, -103, 106, 114, 10, 105, -21, 112, -120, 125, 23, 32, 38, 38, -65 };

void qkv1_head1(
    int8_t * __restrict x,       // mha_in
    int8_t * __restrict q_out,   // Q output
    int8_t * __restrict k_out,   // K output
    int8_t * __restrict v_out    // V output
) {
     // Q
    dense<4, 8, 8, 40, 8, 2, 10, false>(x, q_out, wq_head1);

    // K
    dense<4, 8, 8, 40, 8, 2, 11, false>(x, k_out, wk_head1);

    // V
    dense<4, 8, 8, 40, 8, 2, 11, false>(x, v_out, wv_head1);
}
    
}